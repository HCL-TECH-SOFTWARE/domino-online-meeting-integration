<?xml version='1.0' encoding='utf-8'?>
<agent name='99. Admin\01. Generate Design Element Profiles' xmlns='http://www.lotus.com/dxl'
 version='11.0' maintenanceversion='1.0' replicaid='8525867000756EB9' hide='v3'
 publicaccess='false' designerversion='8.5.3'>
<noteinfo noteid='1ca6' unid='A2A62F256284950885258677004ABB0D' sequence='63'>
<created><datetime>20210209T083615,49-05</datetime></created>
<modified><datetime dst='true'>20210329T124641,14+01</datetime></modified>
<revised><datetime>20210322T100154,94-05</datetime></revised>
<lastaccessed><datetime dst='true'>20210329T124641,13+01</datetime></lastaccessed>
<addedtofile><datetime dst='true'>20210329T124641,13+01</datetime></addedtofile></noteinfo>
<updatedby><name>CN=Rocky Oliver/OU=USA/O=PNPHCL</name></updatedby>
<wassignedby><name>CN=Rocky Oliver/OU=USA/O=PNPHCL</name></wassignedby>
<designchange><datetime>20210322T100154,92-05</datetime></designchange>
<trigger type='actionsmenu'/>
<documentset type='runonce'/><code event='options'><lotusscript>%REM
	Agent Generate Design Element Profiles
	Created Feb 9, 2021 by Rocky Oliver/USA/PNPHCL
	Description: This agent creates a Design Element Profile for each design element in this database
%END REM
Option Public
Option Declare

Use "domiUtilsBE" 
Use "dxlUtilsBE"



</lotusscript></code><code event='initialize'><lotusscript>Sub Initialize
	Dim s As New NotesSession
	Dim thisDb As NotesDatabase
	Dim profDoc As NotesDocument
	Dim desdoc As NotesDocument, eldoc As NotesDocument, desdoc2 As NotesDocument
	Dim titles As Variant, comments As Variant
	Dim nid As String, i As Integer
	Dim dnotecol As NotesNoteCollection
	Dim elementname As String, ucasetitle As String
	Dim aliases As Variant
	Dim tworkarr As Variant
	Dim desname As String, desname2 As String, destypes As String
	Dim retflg As Boolean, commentval As Integer, emptyvar As Variant
	
	On Error GoTo errHandler
	
	Set thisdb = s.CurrentDatabase
	Set dnotecol = getDOMIdesignElements(thisDb)  ' from domiUtilsBE
	If dnotecol.Count = 0 Then Error 1000, "No design elements found"
	
	nid = dnotecol.GetFirstNoteId
	For i = 1 To dnotecol.Count
		commentval = 0
		Set eldoc = thisdb.GetDocumentByID(nid)
		
		If Not(eldoc Is Nothing) Then
			comments = eldoc.GetItemValue("$COMMENT")(0)
			elementname = ""
			aliases = emptyvar
			retflg = getElementNames(eldoc, elementname, aliases)
			Set desdoc = thisdb.CreateDocument
			With desdoc
				.Form = "desElement"
				.elementUNID = eldoc.Universalid
				.Comment = comments
				.Subject = elementname
				.ElementType = getElementType(eldoc)
				.ElementName = elementname
				.ElementAlias = aliases
				.ElementModifiedDate = eldoc.LastModified
				.FeatureFlag = "No"
			End With
			Call desdoc.save(True, False, True)
		End If
		
		nid = dnotecol.GetNextNoteId(nid)
	Next
	
getOut:
	Exit Sub
errHandler:
	Select Case Err
		Case 1000
			MsgBox Error$,48 , "Error"
		Case Else
			MsgBox Error$ &amp; " (err: " &amp; Err &amp; ", erl: " &amp; Erl &amp; ")",48 , "Error"
	End Select
	Resume getOut
End Sub</lotusscript></code>
<rundata processeddocs='0' exitcode='0'>
<agentmodified><datetime>20210322T100154,89-05</datetime></agentmodified></rundata></agent>

